import { kbc_multi_path } from '@phorbas/store/esm/xform/index.js'
import { kbc_web_dom } from '@phorbas/store/esm/web/web_dom.js'
import { WhenMap } from 'whenmap'

export { kbc_multi_path, kbc_web_dom, WhenMap }


export async function kbc_itm_store(elem_db_boot) ::
  let by_path = new WhenMap()

  by_path.set @ 'dom', kbc_web_dom(elem_db_boot)

  let stg = await kbc_multi_path @
    @[] new URLPattern('kbc:/:stg/:key', 'kbc:')
    @{} by_path

  stg.by_path = by_path
  return stg
